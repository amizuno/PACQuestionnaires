I need to make a function for lines 470-500.
